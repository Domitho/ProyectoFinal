{% extends 'empresa/plantillaEmpresa.html' %}
{% load static %}

{% block contenido %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Registrar Empleo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-5">
    <div class="card shadow">
        <div class="card-header bg-primary text-white">
            <h3 class="mb-0">Registrar Oferta de Empleo</h3>
        </div>
        <div class="card-body">
            <form method="post" id="form-empleo">
                {% csrf_token %}

                <div class="mb-3">
                    <label class="form-label">Título</label>
                    <input type="text" name="titulo" class="form-control" required>
                </div>

                <div class="mb-3">
                    <label class="form-label">Descripción</label>
                    <textarea name="descripcion" class="form-control" rows="3" required></textarea>
                </div>

                <div class="mb-3">
                    <label class="form-label">Requisitos</label>
                    <textarea name="requisitos" class="form-control" rows="3"></textarea>
                </div>

                <div class="mb-3">
                    <label class="form-label">Salario (opcional)</label>
                    <input type="number" name="salario" step="0.01" class="form-control">
                </div>

                <div class="mb-3">
                    <label class="form-label">Tipo de Contrato</label>
                    <select name="tipo_contrato" class="form-select">
                        <option value="tiempo completo">Tiempo completo</option>
                        <option value="medio tiempo">Medio tiempo</option>
                        <option value="temporal">Temporal</option>
                        <option value="prácticas">Prácticas</option>
                        <option value="freelance">Freelance</option>
                    </select>
                </div>

                <div class="mb-3">
                    <label class="form-label">Modalidad</label>
                    <select name="modalidad" class="form-select">
                        <option value="presencial">Presencial</option>
                        <option value="remoto">Remoto</option>
                        <option value="híbrido">Híbrido</option>
                    </select>
                </div>

                <div class="mb-3">
                    <label class="form-label">Ciudad</label>
                    <input type="text" name="ciudad" class="form-control">
                </div>

                <div class="mb-3">
                    <label class="form-label">Fecha de Vencimiento</label>
                    <input type="date" name="fecha_vencimiento" class="form-control">
                </div>

                <div class="d-grid">
                    <button type="submit" class="btn btn-success">Publicar Empleo</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- jQuery Validate -->
<script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.5/dist/jquery.validate.min.js"></script>
<!-- SweetAlert2 -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
$(document).ready(function () {
    $('#form-empleo').validate({
        errorClass: 'is-invalid',
        validClass: 'is-valid',
        errorElement: 'div',
        errorPlacement: function (error, element) {
            error.addClass('invalid-feedback');
            if (element.prop('type') === 'radio') {
                error.insertAfter(element.closest('.form-check-inline'));
            } else {
                error.insertAfter(element);
            }
        },
        highlight: function (element, errorClass, validClass) {
            $(element).addClass(errorClass).removeClass(validClass);
        },
        unhighlight: function (element, errorClass, validClass) {
            $(element).removeClass(errorClass).addClass(validClass);
        },
        rules: {
            titulo: "required",
            descripcion: "required",
            ciudad: "required",
            fecha_vencimiento: {
                required: true,
                date: true,
                min: new Date().toISOString().split("T")[0]
            }
        },
        messages: {
            titulo: "Por favor ingrese un título",
            descripcion: "Por favor ingrese una descripción",
            ciudad: "Por favor ingrese una ciudad",
            fecha_vencimiento: {
                required: "Por favor seleccione una fecha",
                date: "Ingrese una fecha válida",
                min: "La fecha debe ser hoy o una posterior"
            }
        },
        submitHandler: function (form) {
            Swal.fire({
                title: '¿Deseas publicar esta oferta?',
                icon: 'question',
                showCancelButton: true,
                confirmButtonText: 'Sí, publicar',
                cancelButtonText: 'Cancelar',
                confirmButtonColor: '#198754',
                cancelButtonColor: '#dc3545'
            }).then((result) => {
                if (result.isConfirmed) {
                    form.submit();
                }
            });
        }
    });
});
</script>

</body>
</html>
{% endblock %}